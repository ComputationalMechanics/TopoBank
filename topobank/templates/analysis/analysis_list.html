{% extends 'base.html' %}
{% load fontawesome %}
{% load crispy_forms_tags %}

{% block content-title %}
  Analysis Results
{% endblock content-title %}

{% block extra_css %}
  {{ form.media.css }}
{% endblock extra_css %}

{% block content %}

  <div>
    <div class="card">
      <div class="card-header">
        Filter results by topographies and analysis functions
      </div>
      <div class="card-body">
        {% crispy form form.helper %}
      </div>
    </div>
  </div>

  <!--
  <div class="row">
  <form>
    <div class="form-control">
      <label for="selectTopographies">Filter topographies</label>
      <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
      <small id="selectTopographiesHelp" class="form-text text-muted">
        Choose one or multiple topographies. You can search interactively by name.
      </small>
    </div>
    <button type="submit" class="btn btn-primary">Update</button>
  </form>
  </div>-->

  <div class="row">
  {% for analysis in analyses %}
      <div class="col-xl-6 mb-4">
        <div class="card">
          <div class="card-header">
            {{ analysis.function.name }} of
            <a href="{% url 'manager:topography-detail' analysis.topography.id %}">{{ analysis.topography.name }}</a>
            <div class="pull-right">
              <small>
              State: {{ analysis.get_task_state_display }}
              {% if analysis.get_args_display %}
              | args: {{ analysis.get_args_display }}
              {% endif %}
              {% if analysis.get_kwargs_display %}
              | kwargs: {{ analysis.get_kwargs_display }}
              {% endif %}
              </small>
            </div>
          </div>
          <div class="card-body">
            <div class="spinner"></div>
            <div class="topobank-scatter-plot topobank-plot-resize" data-src="{% url 'analysis:retrieve' analysis.id %}"></div>
          </div>
          <div class="card-footer">
            <small>
              {% if analysis.start_time %}
                Started: {{ analysis.start_time|date:"Y-m-d H:i:s" }}
                {% if analysis.end_time %}
                | Ended: {{ analysis.end_time|date:"Y-m-d H:i:s" }}
                | Duration: {{ analysis.duration }}
                {% endif %}
              {% endif %}
            </small>
          </div>
        </div>
      </div>
  {% endfor %}
  </div>

{% endblock content %}

{% block javascript %}
  {{ form.media.js }}
{% endblock javascript %}
